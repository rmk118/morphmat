<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Two-line regression method for estimating size at maturity — two_line • morphmat</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><link href="../deps/KaTex-0.16.10/katex.min.css" rel="stylesheet"><script src="../deps/KaTex-0.16.10/katex.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Two-line regression method for estimating size at maturity — two_line"><meta name="description" content="Fits separate linear models for the allometric growth of
immature and mature individuals. Code adapted from Dr. Bradley Stevens at
the University of Maryland Eastern Shore."><meta property="og:description" content="Fits separate linear models for the allometric growth of
immature and mature individuals. Code adapted from Dr. Bradley Stevens at
the University of Maryland Eastern Shore."><meta property="og:image" content="https://rmk118.github.io/morphmat/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">morphmat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/morphmat.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/broken-stick.html">Broken-stick methods</a></li>
    <li><a class="dropdown-item" href="../articles/classification.html">Classification methods</a></li>
    <li><a class="dropdown-item" href="../articles/logistic.html">Post-classification logistic regression</a></li>
    <li><a class="dropdown-item" href="../articles/simulations.html">Simulating data</a></li>
    <li><a class="dropdown-item" href="../articles/two-line.html">Two-line models</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rmk118/morphmat/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Two-line regression method for estimating size at maturity</h1>
      <small class="dont-index">Source: <a href="https://github.com/rmk118/morphmat/blob/master/R/two_line.R" class="external-link"><code>R/two_line.R</code></a></small>
      <div class="d-none name"><code>two_line.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fits separate linear models for the allometric growth of
immature and mature individuals. Code adapted from Dr. Bradley Stevens at
the University of Maryland Eastern Shore.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">two_line</span><span class="op">(</span></span>
<span>  <span class="va">dat</span>,</span>
<span>  <span class="va">xvar</span>,</span>
<span>  <span class="va">yvar</span>,</span>
<span>  lower <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  upper <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  bps <span class="op">=</span> <span class="st">"even"</span>,</span>
<span>  log <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  num_bps <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dat">dat<a class="anchor" aria-label="anchor" href="#arg-dat"></a></dt>
<dd><p>data frame or matrix containing the data</p></dd>


<dt id="arg-xvar">xvar<a class="anchor" aria-label="anchor" href="#arg-xvar"></a></dt>
<dd><p>Name of column (integer or double) of measurements for the x-axis
variable (e.g., carapace width).</p></dd>


<dt id="arg-yvar">yvar<a class="anchor" aria-label="anchor" href="#arg-yvar"></a></dt>
<dd><p>Name of column (integer or double) of measurements for the y-axis
variable (e.g., claw height).</p></dd>


<dt id="arg-lower">lower<a class="anchor" aria-label="anchor" href="#arg-lower"></a></dt>
<dd><p>Integer or double; the lower bound for possible SM50 values.
Must be on the same scale of the data. Defaults to the 20th percentile of
the x-variable.</p></dd>


<dt id="arg-upper">upper<a class="anchor" aria-label="anchor" href="#arg-upper"></a></dt>
<dd><p>Integer or double; the upper bound for possible SM50 values.
Must be on the same scale of the data. Defaults to the 80th percentile of
the x-variable.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Should additional output be returned besides the SM50
estimate?</p></dd>


<dt id="arg-bps">bps<a class="anchor" aria-label="anchor" href="#arg-bps"></a></dt>
<dd><p>Should the values tested as possible breakpoints be restricted to
only observed values of the x-variable ("obs"), or should it be a specified
number of evenly-spaced values between the lower and upper limits of the
unknown region ("even", the default)</p></dd>


<dt id="arg-log">log<a class="anchor" aria-label="anchor" href="#arg-log"></a></dt>
<dd><p>Boolean; should both variables be log-transformed before performing the
regression? Defaults to FALSE.</p></dd>


<dt id="arg-num-bps">num_bps<a class="anchor" aria-label="anchor" href="#arg-num-bps"></a></dt>
<dd><p>When <code>bps = "even"</code>, how many values should be tested as
possible endpoints? Defaults to 100, but should be increased.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If verbose is FALSE (the default), two possible estimates of SM50:
the breakpoint x-value marking the transition between immature and mature
points/lines, and the intersection point where the two lines cross. The
intersection value will typically be extremely unrealistic unless the
slopes of the lines are drastically different. If verbose is TRUE, output
is a list that also includes the original data with a column representing
which line (immature or mature) the point was assigned to, the immature and
mature slope and intercept parameters, and the intersection point of the
two lines.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The optimal breakpoint between lines is found by minimizing the
residual sum of squares when iterating over (1) num_bps evenly-spaced
values within the possible range or (2) all values of the x-axis variable
present in the unknown range.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="two_line_logistic.html">two_line_logistic()</a></code> for an alternative two-line model with a
logistic transition between the left and right segments and
<code><a href="piecewise_mods.html">piecewise_mods()</a></code> for segmented/piecewise regression methods.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#' set.seed(12)</span></span></span>
<span class="r-in"><span><span class="va">fc</span> <span class="op">&lt;-</span> <span class="fu"><a href="fake_crustaceans.html">fake_crustaceans</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, L50 <span class="op">=</span> <span class="fl">100</span>, allo_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.2</span>, <span class="fl">1.1</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">two_line</span><span class="op">(</span><span class="va">fc</span>, xvar <span class="op">=</span> <span class="st">"x"</span>, yvar <span class="op">=</span> <span class="st">"y"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   breakpoint intersection </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     104.1017    1561.0893 </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ruby Krasnow.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

