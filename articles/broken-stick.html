<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Broken-stick methods • morphmat</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><link href="../deps/KaTex-0.16.10/katex.min.css" rel="stylesheet">
<script src="../deps/KaTex-0.16.10/katex.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Broken-stick methods">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">morphmat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/morphmat.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/broken-stick.html">Broken-stick methods</a></li>
    <li><a class="dropdown-item" href="../articles/classification.html">Classification methods</a></li>
    <li><a class="dropdown-item" href="../articles/logistic.html">Post-classification logistic regression</a></li>
    <li><a class="dropdown-item" href="../articles/simulations.html">Simulating data</a></li>
    <li><a class="dropdown-item" href="../articles/two-line.html">Two-line models</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rmk118/morphmat/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Broken-stick methods</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rmk118/morphmat/blob/master/vignettes/articles/broken-stick.Rmd" class="external-link"><code>vignettes/articles/broken-stick.Rmd</code></a></small>
      <div class="d-none name"><code>broken-stick.Rmd</code></div>
    </div>

    
    
<p>Sources (more will be added): Somerton <span class="citation">(<a href="#ref-somerton1980">1980</a>; <a href="#ref-somerton1980a">D. A.
Somerton 1980</a>)</span>; Muggeo <span class="citation">(<a href="#ref-muggeo2003">2003</a>, <a href="#ref-muggeo2017">2017</a>; <a href="#ref-muggeo2008">V. Muggeo 2008</a>)</span>; Hall et al. <span class="citation">(<a href="#ref-hall2006">2006</a>)</span></p>
<p><span class="math display">\begin{equation*}\log{y}=
    \begin{cases}
     \tilde{\beta_1} + \alpha_1 \log{x}             &amp; \text{for
}\log{x} \leq c \\
     \tilde{\beta_1} + c(\alpha_1-\alpha_2)+\alpha_2 \log{x}  &amp;
\text{for }\log{x} &gt; c
    \end{cases}       
\end{equation*}</span></p>
<p>At <span class="math inline">\log{x}=c</span>, the bottom equation
becomes <span class="math inline">\tilde{\beta_1}+(\log{x})(\alpha_1-\alpha_2)+\alpha_2\log{x}</span>,
equivalent to the top equation. Note that in this formulation, there is
only one intercept term <span class="math inline">(\beta_1)</span>, so
the immature and mature lines cannot have the same slope without being
equivalent lines. In this model, the estimated value of the breakpoint
parameter <span class="math inline">c</span> is taken to be SM50.</p>
<p>We will start by simulating a data set with a known SM50 value of 75
mm to demonstrate the use (and limitations) of broken-stick methods.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span> <span class="co"># set seed for reproducibility</span></span>
<span></span>
<span><span class="va">fc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fake_crustaceans.html">fake_crustaceans</a></span><span class="op">(</span></span>
<span>  error_scale <span class="op">=</span> <span class="fl">17</span>,</span>
<span>  slope <span class="op">=</span> <span class="fl">9</span>,</span>
<span>  L50 <span class="op">=</span> <span class="fl">75</span>, <span class="co"># known size at maturity is 75 mm</span></span>
<span>  n <span class="op">=</span> <span class="fl">800</span>, <span class="co"># sample size</span></span>
<span>  allo_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0.25</span>, <span class="fl">1.05</span>, <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>  x_mean <span class="op">=</span> <span class="fl">85</span> <span class="co"># mean carapace width of the sample</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="broken-stick_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="section level2">
<h2 id="segmented-package">segmented package<a class="anchor" aria-label="anchor" href="#segmented-package"></a>
</h2>
<p>A powerful and customizable method of implementing broken-stick
regression is provided by the R package <code>segmented</code>, which
has been cited by many papers using morphometric data to estimate size
at maturity. Note that <code>segmented</code> includes three different
methods to compute confidence intervals, the details of which are
discussed in Muggeo <span class="citation">(<a href="#ref-muggeo2017">2017</a>)</span>. It is also possible to estimate
95% CIs via bootstrap resampling, but the computation time required is
relatively high and the resulting estimates are around the same values
as those from the “delta” and “gradient” methods included in the
<code>segmented</code> package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lm_orig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">fc</span><span class="op">)</span></span>
<span><span class="va">lm_orig_seg</span> <span class="op">&lt;-</span> <span class="fu">segmented</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/segmented/man/segmented.html" class="external-link">segmented</a></span><span class="op">(</span><span class="va">lm_orig</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lm_orig_seg</span><span class="op">)</span></span></code></pre></div>
<p><img src="broken-stick_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>The segmented package has three built-in methods to get 95%
confidence intervals for the break point:</p>
<pre><code><span><span class="co">#&gt; Delta method:</span></span></code></pre>
<pre><code><span><span class="co">#&gt;           Est. CI(95%).low CI(95%).up</span></span>
<span><span class="co">#&gt; psi1.x 63.9545     57.1425    70.7665</span></span></code></pre>
<pre><code><span><span class="co">#&gt; Score method:</span></span></code></pre>
<pre><code><span><span class="co">#&gt;           Est. CI(95%).low CI(95%).up</span></span>
<span><span class="co">#&gt; psi1.x 63.9545     50.1308    67.6307</span></span></code></pre>
<pre><code><span><span class="co">#&gt; Gradient method:</span></span></code></pre>
<pre><code><span><span class="co">#&gt;           Est. CI(95%).low CI(95%).up</span></span>
<span><span class="co">#&gt; psi1.x 63.9545     53.7911    70.2144</span></span></code></pre>
<p>We can also use an ANOVA test to compare the segmented model to a
single linear model:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">lm_orig</span>, <span class="va">lm_orig_seg</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Analysis of Variance Table</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model 1: y ~ x</span></span>
<span><span class="co">#&gt; Model 2: y ~ x + U1.x + psi1.x</span></span>
<span><span class="co">#&gt;   Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; 1    798 7866.2                                  </span></span>
<span><span class="co">#&gt; 2    796 7629.8  2     236.4 12.332 5.318e-06 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre>
<div class="figure">
<img src="broken-stick_files/figure-html/fig-segmented-plot-1.png" alt="SM50 estimate for simulated crab data from the R package segmented" width="700"><p class="caption">
SM50 estimate for simulated crab data from the R package segmented
</p>
</div>
</div>
<div class="section level2">
<h2 id="chngpt-package">chngpt package<a class="anchor" aria-label="anchor" href="#chngpt-package"></a>
</h2>
<p>Another R package with the capability of segmented regression is
called <code>chngpt</code>. This package differs slightly from
<code>segmented</code> in the types of threshold models that are
supported, the optimization algorithms used for parameter estimation,
and the method(s) used to calculate confidence intervals for the
breakpoint <span class="citation">(<a href="#ref-fong2017">Fong et al.
2017</a>)</span>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_chngpt</span> <span class="op">&lt;-</span> <span class="fu">chngptm</span><span class="op">(</span></span>
<span>  formula.1 <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  formula.2 <span class="op">=</span>  <span class="op">~</span> <span class="va">x</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fc</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"segmented"</span>,</span>
<span>  var.type <span class="op">=</span> <span class="st">"default"</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_chngpt</span><span class="op">)</span></span>
<span><span class="co">#&gt; Change point model threshold.type:  segmented </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                    est Std. Error*     (lower    upper)     p.value*</span></span>
<span><span class="co">#&gt; (Intercept) -0.9153689  0.62858364 -1.9643531 0.4996948 1.453262e-01</span></span>
<span><span class="co">#&gt; x            0.2005470  0.01357774  0.1688772 0.2221020 2.277627e-49</span></span>
<span><span class="co">#&gt; (x-chngpt)+  0.1425691  0.01659954  0.1134477 0.1785179 8.793325e-18</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Threshold:</span></span>
<span><span class="co">#&gt;        est Std. Error     (lower     upper) </span></span>
<span><span class="co">#&gt;  63.954507   2.031396  58.890638  66.853710</span></span></code></pre></div>
<div class="figure">
<img src="broken-stick_files/figure-html/fig-chngpt-plots-1.png" alt="Broken-stick model from the package chngpt" width="700"><p class="caption">
Broken-stick model from the package chngpt
</p>
</div>
<div class="figure">
<img src="broken-stick_files/figure-html/fig-chngpt-plots-2.png" alt="Log likelihood of the model at various breakpoint values" width="700"><p class="caption">
Log likelihood of the model at various breakpoint values
</p>
</div>
<div class="figure">
<img src="broken-stick_files/figure-html/fig-chngpt-plots-3.png" alt="Bootstrap 95% confidence intervals" width="700"><p class="caption">
Bootstrap 95% confidence intervals
</p>
</div>
<p>As with the <code>segmented</code> package, it seems to have
significantly underestimated SM50 compared to the true value of 75,
which is not contained within the bootstrap confidence intervals. An
alternative method for calculating confidence intervals (“model-based”)
produces very similar results to the default bootstrap method.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span></span>
<span>  <span class="fu">chngptm</span><span class="op">(</span></span>
<span>    formula.1 <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>    formula.2 <span class="op">=</span>  <span class="op">~</span> <span class="va">x</span>,</span>
<span>    family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>    data <span class="op">=</span> <span class="va">fc</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"segmented"</span>,</span>
<span>    var.type <span class="op">=</span> <span class="st">"model"</span>, <span class="co"># note change from default to model</span></span>
<span>    weights <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span><span class="op">[[</span><span class="st">"chngpt"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;        est Std. Error     (lower     upper) </span></span>
<span><span class="co">#&gt;  63.954507   3.364602  55.814677  69.003917</span></span></code></pre></div>
<p>Adding a starting breakpoint value of 75 (i.e., initializing the
search at the correct value) through the “chngpt.init” argument does not
affect the estimate, although it does result in narrower confidence
intervals:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span></span>
<span>  <span class="fu">chngptm</span><span class="op">(</span></span>
<span>    formula.1 <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>    formula.2 <span class="op">=</span>  <span class="op">~</span> <span class="va">x</span>,</span>
<span>    family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>    data <span class="op">=</span> <span class="va">fc</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"segmented"</span>,</span>
<span>    chngpt.init <span class="op">=</span> <span class="fl">75</span>,</span>
<span>    weights <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span><span class="op">[[</span><span class="st">"chngpt"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;        est Std. Error     (lower     upper) </span></span>
<span><span class="co">#&gt;  63.954507   2.031396  58.890638  66.853710</span></span></code></pre>
<p>This method is EXTREMELY sensitive to the “lb.quantile” and
“ub.quantile” arguments, which refer to the lower and upper bounds of
the search range for change point estimate, respectively (the function
defaults are 0.05 and 0.95). For example, if we change the lower
quantile bound to 0.33 and the upper to 0.66, the model will return an
SM50 value closer to the true value of 75 mm.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span></span>
<span>  <span class="fu">chngptm</span><span class="op">(</span></span>
<span>    formula.1 <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>    formula.2 <span class="op">=</span>  <span class="op">~</span> <span class="va">x</span>,</span>
<span>    family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>    data <span class="op">=</span> <span class="va">fc</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"segmented"</span>,</span>
<span>    var.type <span class="op">=</span> <span class="st">"model"</span>,</span>
<span>    lb.quantile <span class="op">=</span> <span class="fl">0.33</span>,</span>
<span>    ub.quantile <span class="op">=</span> <span class="fl">0.66</span>,</span>
<span>    weights <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span><span class="op">[[</span><span class="st">"chngpt"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;      est </span></span>
<span><span class="co">#&gt; 76.00473</span></span></code></pre>
<p>The estimates and accuracy also change dramatically even with
slightly different variations of data with the exact same underlying
structure. Results from detailed investigations of the sensitivity of
each modeling approach will be available in a forthcoming paper (Krasnow
et al., <em>in prep</em>).</p>
<p>Although we will not test all of the options here, the
<code>chngpt</code> package supports 14 different types of two-phase
(one threshold) models, as well as one three-phase model: see <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC10722876/" class="external-link">Fig. 1</a>
in Son and Fong <span class="citation">(<a href="#ref-son2021">2021</a>)</span>. Importantly, it also supports
generalized linear models and linear mixed models, so you can fit models
utilizing any family that can be passed to <code>glm</code> and include
other covariates and random effects. Additional benefits of this package
include several functions to simulate data and the significant
capability of user-friendly customization. Options include providing
your own grid of changepoints to iterate over, using five different
types of bootstrap CIs with numerous options for each type, providing a
bound on the slope parameters for the lines on either side of the
breakpoint, and changing the search/optimization algorithm for parameter
estimation to meet the needs of your data (e.g., “fastgrid2” is very
fast and might be helpful for large data sets).</p>
<p>Using the <code><a href="https://rdrr.io/pkg/chngpt/man/chngpt.test.html" class="external-link">chngpt::chngpt.test()</a></code> function to run
significance tests:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Model with default upper and lower bounds</span></span>
<span><span class="fu">chngpt.test</span><span class="op">(</span></span>
<span>  formula.null <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  formula.chngpt <span class="op">=</span> <span class="op">~</span> <span class="va">x</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fc</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"segmented"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Maximum of Likelihood Ratio Statistics</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  fc</span></span>
<span><span class="co">#&gt; Maximal statistic = 24.358, threshold = 64.292, p-value &lt; 2.2e-16</span></span>
<span><span class="co">#&gt; alternative hypothesis: two-sided</span></span>
<span></span>
<span><span class="co"># Model with better upper and lower bounds to return</span></span>
<span><span class="co"># the true SM50 of 75 mm (0.6 and 0.3)</span></span>
<span><span class="fu">chngpt.test</span><span class="op">(</span></span>
<span>  formula.null <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  formula.chngpt <span class="op">=</span> <span class="op">~</span> <span class="va">x</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fc</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"segmented"</span>,</span>
<span>  lb.quantile <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  ub.quantile <span class="op">=</span> <span class="fl">0.6</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Maximum of Likelihood Ratio Statistics</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  fc</span></span>
<span><span class="co">#&gt; Maximal statistic = 13.909, threshold = 74.531, p-value = 0.00036</span></span>
<span><span class="co">#&gt; alternative hypothesis: two-sided</span></span></code></pre></div>
<p>It is interesting that this function returns a slightly different
breakpoint/threshold estimate from the <code><a href="https://rdrr.io/pkg/chngpt/man/chngptm.html" class="external-link">chngpt::chngptm()</a></code>
function when both are called using the default search region bounds
(regardless of what set.seed is set to before calling the functions).
Additionally, the test statistic for the model with the less accurate
breakpoint estimate is much higher than for the more accurate model,
yielding a lower p-value.</p>
</div>
<div class="section level2">
<h2 id="regrans">REGRANS<a class="anchor" aria-label="anchor" href="#regrans"></a>
</h2>
<p>We will also test the broken-stick method by manually coding an
algorithm to identify the appropriate breakpoint. The following code is
conceptually very similar to the R version of REGRANS, which was
initially written in 1993 in the programming language BASIC <span class="citation">(<a href="#ref-pezzuto1993"><strong>pezzuto1993?</strong></a>)</span>.</p>
<p>You can optionally define lower and upper limits for the changepoints
you want this function to test; otherwise, it tests a user-defined
number of evenly-spaced values (default = 100) ranging from the 0.2
quantile to the 0.8 quantile of the x-axis variable.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regrans_est</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/regrans.html">regrans</a></span><span class="op">(</span><span class="va">fc</span>, <span class="st">"x"</span>, <span class="st">"y"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">regrans_est</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 67.67091</span></span></code></pre>
<p><img src="broken-stick_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<p>As with the previous broken-stick methods, REGRANS tends to
underestimate SM50 and the model estimates are highly sensitive to the
values of the upper and lower bounds of the region considered plausible
to contain the SM50 value.</p>
</div>
<div class="section level2">
<h2 id="crab_maturity-type-a-broken-stick-stevens">Crab_Maturity Type A (Broken-stick Stevens)<a class="anchor" aria-label="anchor" href="#crab_maturity-type-a-broken-stick-stevens"></a>
</h2>
<p>A third algorithm for using segmented regression to estimate SM50 was
written by Dr. Bradley Stevens at the University of Maryland Eastern
Shore. This code is part of the <a href="https://github.com/Crabman52/Crustacean_Sensation" class="external-link">Crab_Maturity
program</a> available on GitHub. There are several different methods
included within Crab_Maturity; this segmented regression approach is
included here because it differs from the <code>segmented</code> and
REGRANS methods in that <em>possible SM50 values are restricted to
values of the x-variable present in the data set</em>.</p>
<p>See Olsen and Stevens <span class="citation">(<a href="#ref-olsen2020">2020</a>)</span> for an example real-world
application.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stevens_est</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/broken_stick_stevens.html">broken_stick_stevens</a></span><span class="op">(</span><span class="va">fc</span>, <span class="st">"x"</span>, <span class="st">"y"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">stevens_est</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 68.33387</span></span></code></pre>
<p><img src="broken-stick_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-fong2017" class="csl-entry">
Fong, Youyi, Ying Huang, Peter B. Gilbert, and Sallie R. Permar. 2017.
<span>“Chngpt: Threshold Regression Model Estimation and
Inference.”</span> <em>BMC Bioinformatics</em> 18 (1): 454. <a href="https://doi.org/10.1186/s12859-017-1863-x" class="external-link">https://doi.org/10.1186/s12859-017-1863-x</a>.
</div>
<div id="ref-hall2006" class="csl-entry">
Hall, Norman G., Kim D. Smith, Simon de Lestang, and Ian C. Potter.
2006. <span>“Does the Largest Chela of the Males of Three Crab Species
Undergo an Allometric Change That Can Be Used to Determine Morphometric
Maturity?”</span> <em>ICES Journal of Marine Science</em> 63 (1):
140–50. <a href="https://doi.org/10.1016/j.icesjms.2005.07.007" class="external-link">https://doi.org/10.1016/j.icesjms.2005.07.007</a>.
</div>
<div id="ref-muggeo2008" class="csl-entry">
Muggeo, Vito. 2008. <span>“Segmented: An r Package to Fit Regression
Models with Broken-Line Relationships.”</span> <em>R News</em> 8 (1):
20–25. <a href="https://journal.r-project.org/articles/RN-2008-004/RN-2008-004.pdf" class="external-link">https://journal.r-project.org/articles/RN-2008-004/RN-2008-004.pdf</a>.
</div>
<div id="ref-muggeo2003" class="csl-entry">
Muggeo, Vito M. R. 2003. <span>“Estimating Regression Models with
Unknown Break-Points.”</span> <em>Statistics in Medicine</em> 22 (19):
3055–71. <a href="https://doi.org/dsrbfd" class="external-link">https://doi.org/dsrbfd</a>.
</div>
<div id="ref-muggeo2017" class="csl-entry">
———. 2017. <span>“Interval Estimation for the Breakpoint in Segmented
Regression: A Smoothed Score-Based Approach.”</span> <em>Australian
&amp; New Zealand Journal of Statistics</em> 59 (3): 311–22. <a href="https://doi.org/gkzpsc" class="external-link">https://doi.org/gkzpsc</a>.
</div>
<div id="ref-olsen2020" class="csl-entry">
Olsen, Noelle A., and Bradley G. Stevens. 2020. <span>“Size at Maturity,
Shell Conditions, and Morphometric Relationships of Male and Female
Jonah Crabs in the Middle Atlantic Bight.”</span> <em>North American
Journal of Fisheries Management</em> 40 (6): 1472–85. <a href="https://doi.org/10.1002/nafm.10509" class="external-link">https://doi.org/10.1002/nafm.10509</a>.
</div>
<div id="ref-somerton1980a" class="csl-entry">
Somerton, D. A. 1980. <span>“Fitting Straight Lines to Hiatt Growth
Diagrams: A Re-Evaluation.”</span> <em>ICES Journal of Marine
Science</em> 39 (1): 15–19. <a href="https://doi.org/10.1093/icesjms/39.1.15" class="external-link">https://doi.org/10.1093/icesjms/39.1.15</a>.
</div>
<div id="ref-somerton1980" class="csl-entry">
Somerton, David A. 1980. <span>“A Computer Technique for Estimating the
Size of Sexual Maturity in Crabs.”</span> <em>Canadian Journal of
Fisheries and Aquatic Sciences</em> 37 (10): 1488–94. <a href="https://doi.org/10.1139/f80-192" class="external-link">https://doi.org/10.1139/f80-192</a>.
</div>
<div id="ref-son2021" class="csl-entry">
Son, Hyunju, and Youyi Fong. 2021. <span>“Fast Grid Search and
Bootstrap-Based Inference for Continuous Two-Phase Polynomial Regression
Models.”</span> <em>Environmetrics</em> 32 (3): e2664. <a href="https://doi.org/10.1002/env.2664" class="external-link">https://doi.org/10.1002/env.2664</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ruby Krasnow.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
