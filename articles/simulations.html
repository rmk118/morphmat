<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Simulating data • morphmat</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><link href="../deps/KaTex-0.16.10/katex.min.css" rel="stylesheet">
<script src="../deps/KaTex-0.16.10/katex.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulating data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">morphmat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/morphmat.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/broken-stick.html">Broken-stick methods</a></li>
    <li><a class="dropdown-item" href="../articles/classification.html">Classification methods</a></li>
    <li><a class="dropdown-item" href="../articles/simulations.html">Simulating data</a></li>
    <li><a class="dropdown-item" href="../articles/two-line.html">Two-line models</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rmk118/morphmat/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Simulating data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rmk118/morphmat/blob/master/vignettes/simulations.Rmd" class="external-link"><code>vignettes/simulations.Rmd</code></a></small>
      <div class="d-none name"><code>simulations.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rmk118/morphmat" class="external-link">morphmat</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Testing a proposed model against simulated data generated from a
known underlying process is an important but sometimes overlooked step
in ecological research <span class="citation">(<a href="#ref-lotterhos2022">Lotterhos, Fitzpatrick, and Blackmon 2022</a>;
<a href="#ref-austin2006">Austin et al. 2006</a>)</span>. In fisheries
science, simulation testing is commonly used to evaluate stock
assessment and population dynamic models and assess their robustness to
various types of error <span class="citation">(<a href="#ref-deroba2015">Deroba et al. 2015</a>; <a href="#ref-piner2011">Piner et al. 2011</a>)</span>. Before applying our
size-at-maturity estimation procedures to the actual Jonah crab data, we
created multiple simulated data sets with differing characteristics in
order to determine the domains of applicability and inference of our
model. The domain of applicability refers to the types of situations and
data sets to which a model can reliably be applied, while the domain of
inference is defined as the processes or conclusions that can be
inferred from the model output <span class="citation">(<a href="#ref-lotterhos2022">Lotterhos, Fitzpatrick, and Blackmon
2022</a>)</span>.</p>
<div class="section level3">
<h3 id="basic-simulation-steps">Basic simulation steps<a class="anchor" aria-label="anchor" href="#basic-simulation-steps"></a>
</h3>
<ol style="list-style-type: decimal">
<li>Create normal distribution of crabs with given mean and SD for
carapace width (CW)</li>
<li>Use logistic distribution function with known location and scale
parameters (i.e., known L50 and steepness of the logistic curve) to find
the probability of maturity for each individual</li>
<li>Using given parameters for the slope and intercept of the allometric
equation, find the predicted chela height (CH) for each individual based
on their carapace width</li>
<li>Add error representing individual variation in allometric growth,
which we assume to be log-normally distributed. Variance in empirical
size-at-maturity data often appears higher for mature individuals, so by
assuming a multiplicative error structure, these errors will be
proportional to the x-axis variable. For example, a measurement error of
4 mm would be less likely to occur when measuring a crab with a carapace
that is 30 mm in length (a 13% error) than for a crab with a 100-mm
carapace (a 4% error).</li>
<li>Use different combinations of logistic and allometric parameters to
determine how the model approach performs given varying possibilities
for the true underlying biological process. We will also include several
possibilities for the amount of noise present in the data by changing
the magnitude of both types errors. The collection of parameter sets
will include some extreme combinations that represent challenging or
“adversarial” data sets. Such simulations help determine the domain of
applicability by assessing model performance across a range of
biologically realistic data sets that capture the variation and
imperfection found in empirical data <span class="citation">(<a href="#ref-lotterhos2022">Lotterhos, Fitzpatrick, and Blackmon
2022</a>)</span>.</li>
</ol>
</div>
<div class="section level3">
<h3 id="equations">Equations<a class="anchor" aria-label="anchor" href="#equations"></a>
</h3>
<p>The parameterization of the logistic equation we will use is: <span class="math display">f(x)=\frac{1}{1+e^{-(x-a)/b}} </span> where <span class="math inline">a</span> is a location parameter and <span class="math inline">b</span> is the shape parameter.</p>
<p>The allometric growth equation is <span class="math display">Y=\beta
X^{\alpha}</span></p>
<p>which results in a linear plot when log-transformed: <span class="math inline">\log{(Y)}= \tilde{\beta}+\alpha\log{(X)}</span>.
Here, <span class="math inline">\alpha</span> is the slope of the
allometric line and <span class="math inline">\beta</span> is the
intercept, with <span class="math inline">\tilde{\beta}=\log{(\beta)}</span>. Differences in
the intercept of the allometry indicate differences in the proportionate
size of the chela, irrespective of carapace width. In contrast,
differences in the slope parameter represent differences in how the
relative size of the chela changes with body size.</p>
</div>
<div class="section level3">
<h3 id="a-note-on-the-error-distribution">A note on the error distribution<a class="anchor" aria-label="anchor" href="#a-note-on-the-error-distribution"></a>
</h3>
<p>We assume that the errors added in Step 4 are normally distributed
around the regression lines obtained by log-transforming the raw CW and
CH values. In other words, we are assuming the original data has
multiplicative log-normally distributed error:</p>
<p><span class="math display">Y=\beta X^{\alpha}e^{\varepsilon}, \quad
\varepsilon \sim N(0,\sigma^2)</span> <span class="math display">\log{(Y)}=\log{(\beta)}+
\alpha\log{(X)}+\varepsilon, \quad \varepsilon \sim
N(0,\sigma^2)</span></p>
<p>The question of whether error structures should be assumed to be
multiplicative or additive when fitting allometric models is non-trivial
and often controversial <span class="citation">(<a href="#ref-packard2009">Packard 2009</a>; <a href="#ref-ballantyne2013">Ballantyne 2013</a>; <a href="#ref-xiao2011">Xiao et al. 2011</a>)</span>. However, the
assumption of multiplicative error is often appropriate for biological
contexts and in this case, simulating error based on a multiplicative
structure generates artificial data sets that adequately resemble the
empirical morphometric data sets we are interested in <span class="citation">(<a href="#ref-xiao2011">Xiao et al. 2011</a>; <a href="#ref-kerkhoff2009">Kerkhoff and Enquist 2009</a>)</span>.
Alternative error distributions for allometric models continue to be
developed, and future extensions of our research could consider the
performance of various size-at-maturity models when applied to simulated
data with different forms of error <span class="citation">(<a href="#ref-echavarr%C3%ADa-heras2024">Echavarría-Heras et al.
2024</a>)</span>.</p>
</div>
</div>
<div class="section level2">
<h2 id="default-parameters">Default parameters<a class="anchor" aria-label="anchor" href="#default-parameters"></a>
</h2>
<p>Let’s visualize some characteristics of the underlying data set
(without error) when called with the default parameters. The default is
for the function to generate a random sample of 1000 crabs with a mean
carapace width of 105 mm and standard deviation of 20 mm. The true size
at maturity for the population is 100 mm, and the slope parameter for
the logistic equation is 5. There is no change in the allometric slope
or intercept parameters <span class="math inline">(\alpha=1.2,
\beta=0.15)</span> upon reaching maturity, so if this was real data, we
would not actually be able to estimate size at maturity based on a
change in morphometric ratios. The SD of the error distribution also
remains constant upon reaching maturity.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">default_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fake_crustaceans.html">fake_crustaceans</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">default_sim_long</span> <span class="op">&lt;-</span> <span class="va">default_sim</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>reg_x <span class="op">=</span> <span class="va">x</span>, reg_y <span class="op">=</span> <span class="va">y</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">reg_x</span>, <span class="va">reg_y</span>, <span class="va">log_x</span>, <span class="va">log_y</span><span class="op">)</span>,</span>
<span>    names_sep <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>    names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"log"</span>, <span class="st">"var"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>log <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">log</span> <span class="op">==</span> <span class="st">"log"</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#visualize crab size distribution</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">default_sim</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">)</span>, bins <span class="op">=</span> <span class="fl">35</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Carapace width (mm)"</span>, y <span class="op">=</span> <span class="st">"Count"</span><span class="op">)</span> <span class="op">+</span> <span class="va">mytheme</span></span></code></pre></div>
<div class="figure">
<img src="simulations_files/figure-html/fig-defaulthist-1.png" alt="Histogram of carapace widths" width="80%"><p class="caption">
Histogram of carapace widths
</p>
</div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Size by maturity stage histogram</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">default_sim</span>, </span>
<span>              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, group<span class="op">=</span><span class="va">mature</span>, color<span class="op">=</span><span class="va">mature</span>, fill<span class="op">=</span><span class="va">mature</span><span class="op">)</span>, alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="va">mytheme</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>fill<span class="op">=</span><span class="cn">NULL</span>, color<span class="op">=</span><span class="cn">NULL</span>, x<span class="op">=</span><span class="st">"Carapace width (mm)"</span>, y<span class="op">=</span><span class="st">"Density"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span><span class="op">=</span><span class="st">"#368aab"</span>,<span class="st">"1"</span><span class="op">=</span><span class="st">"#993843"</span><span class="op">)</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>                     labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span><span class="op">=</span><span class="st">"Immature"</span>, <span class="st">"1"</span><span class="op">=</span><span class="st">"Mature"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span><span class="op">=</span><span class="st">"#7bbcd5"</span>,<span class="st">"1"</span><span class="op">=</span><span class="st">"#CA6E78"</span><span class="op">)</span>,</span>
<span>                    breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>                    labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span><span class="op">=</span><span class="st">"Immature"</span>, <span class="st">"1"</span><span class="op">=</span><span class="st">"Mature"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="simulations_files/figure-html/fig-defaultdensity-1.png" alt="Distribution of carapace widths by maturity level" width="80%"><p class="caption">
Distribution of carapace widths by maturity level
</p>
</div>
<p>Now we finally plot our two variables of interest:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp_df</span> <span class="op">&lt;-</span> <span class="va">default_sim_long</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">var</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">temp_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>, color<span class="op">=</span><span class="va">mature</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0.5</span>, size<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">log</span>, scales <span class="op">=</span> <span class="st">"free"</span>, </span>
<span>              labeller <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/as_labeller.html" class="external-link">as_labeller</a></span><span class="op">(</span></span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FALSE"</span> <span class="op">=</span> <span class="st">"Normal scale"</span>, <span class="st">"TRUE"</span> <span class="op">=</span> <span class="st">"Log scale"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="va">mytheme</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"Carapace width (mm)"</span>, y<span class="op">=</span><span class="st">"Chela height (mm)"</span>, color<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span><span class="op">=</span><span class="st">"#7bbcd5"</span>,<span class="st">"1"</span><span class="op">=</span><span class="st">"#CA6E78"</span><span class="op">)</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>                     labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span><span class="op">=</span><span class="st">"Immature"</span>, <span class="st">"1"</span><span class="op">=</span><span class="st">"Mature"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">temp_df</span>,<span class="va">log</span><span class="op">==</span><span class="cn">TRUE</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             lty<span class="op">=</span><span class="st">"dashed"</span>, color<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">temp_df</span>,<span class="va">log</span><span class="op">==</span><span class="cn">FALSE</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span>
<span>             lty<span class="op">=</span><span class="st">"dashed"</span>, color<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="simulations_files/figure-html/fig-defaultlineserror-1.png" alt="Carapace width vs. chela height using the default simulation parameters. Vertical grey lines represent the size at maturity used in the logistic equation (100 mm)." width="700"><p class="caption">
Carapace width vs. chela height using the default simulation parameters.
Vertical grey lines represent the size at maturity used in the logistic
equation (100 mm).
</p>
</div>
</div>
<div class="section level2">
<h2 id="changing-parameters">Changing parameters<a class="anchor" aria-label="anchor" href="#changing-parameters"></a>
</h2>
<div class="section level3">
<h3 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h3>
<p>Now, we will adjust the input values to our simulation function to
generate more realistic data. We will change the parameters in three
ways: the slope of the logistic curve (the sharpness of the transition
to maturity), the allometric slope and intercept, and the magnitude of
the error in the data.</p>
<p>Instead of leaving the slope parameter at 5, we will try values from
1 to 10. Values above 10 were initially tested, but the degree of
overlap between the mature and immature groups was far beyond what is
likely to be observed in nature.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slope_options</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p>We will test five different options for how allometric growth changes
upon reaching maturity, including the default of no change.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Create data frame of allometric parameter vectors</span></span>
<span><span class="va">params_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span> <span class="va">name</span>, <span class="op">~</span> <span class="va">vec</span>,</span>
<span>  <span class="co"># No change in the slope or intercept - default</span></span>
<span>  <span class="st">"no_change"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">0.1</span>, <span class="fl">1.2</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co"># No change in the slope, slight increase in the intercept: the relative size</span></span>
<span>  <span class="co"># of chela is the same with varying CWs within a maturity stage, but becomes</span></span>
<span>  <span class="co"># proportionally larger upon reaching maturity.</span></span>
<span>  <span class="st">"parallel"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.1</span>, <span class="fl">0.1</span>, <span class="fl">1.1</span>, <span class="fl">0.15</span><span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co"># Slight increase in the slope, no change in the intercept. The relative size</span></span>
<span>  <span class="co"># of the chela does not become proportionately larger upon reaching maturity,</span></span>
<span>  <span class="co"># but the rate at which chela size increases with increasing body size is</span></span>
<span>  <span class="co"># higher for adult crabs compared to juveniles (goes from allometric to</span></span>
<span>  <span class="co"># slightly hyperallometric).</span></span>
<span>  <span class="st">"allo_to_hyper"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.2</span>, <span class="fl">1.1</span>, <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co"># Moderate increase in the slope, moderate decrease in the intercept. The</span></span>
<span>  <span class="co"># relative size of the chela becomes smaller upon reaching maturity, but the</span></span>
<span>  <span class="co"># rate at which chela size increases with increasing body size is higher for</span></span>
<span>  <span class="co"># adult crabs compared to juveniles (goes from allometric to hyperallometric).</span></span>
<span>  <span class="st">"crossing"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.25</span>, <span class="fl">1.25</span>, <span class="fl">0.08</span><span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co"># Large increase in the slope, large decrease in the intercept. The relative</span></span>
<span>  <span class="co"># size of the chela becomes much smaller upon reaching maturity, but the rate</span></span>
<span>  <span class="co"># at which chela size increases with increasing body size is much higher for</span></span>
<span>  <span class="co"># adult crabs compared to juveniles (goes from slightly hypoallometric to</span></span>
<span>  <span class="co"># hyperallometric).</span></span>
<span>  <span class="st">"hypo_to_hyper"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0.27</span>, <span class="fl">1.75</span>, <span class="fl">0.006</span><span class="op">)</span></span>
<span><span class="op">)</span>      </span></code></pre></div>
<p>We will test three options for the magnitude of the errors. The three
options will be a normal distribution with an extremely small SD
(essentially no error), a SD equal to 1/20 the range of the x-axis
variable, or a SD of 1/15 the range of the x-axis variable.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">err_options_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">errs</span>, <span class="op">~</span><span class="va">err</span>,</span>
<span>  <span class="st">"none"</span>, <span class="fl">10</span><span class="op">^</span><span class="fl">9</span>,</span>
<span>  <span class="st">"low"</span>,   <span class="fl">20</span>,</span>
<span>  <span class="st">"high"</span>,  <span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<p>Now create data frame with all possible combinations of these
parameters and create a simulated data set for each combination.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">params_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html" class="external-link">expand_grid</a></span><span class="op">(</span><span class="va">params_df</span>, <span class="va">slope_options</span><span class="op">)</span></span>
<span></span>
<span><span class="va">err_params_df</span> <span class="op">&lt;-</span> <span class="va">params_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html" class="external-link">expand_grid</a></span><span class="op">(</span><span class="va">err_options_df</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fake_crustaceans</span> <span class="op">&lt;-</span> <span class="va">err_params_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rowwise.html" class="external-link">rowwise</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/fake_crustaceans.html">fake_crustaceans</a></span><span class="op">(</span></span>
<span>      allo_params <span class="op">=</span> <span class="va">vec</span>,</span>
<span>      slope <span class="op">=</span> <span class="va">slope_options</span>,</span>
<span>      error_scale <span class="op">=</span> <span class="va">err</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="visualization">Visualization<a class="anchor" aria-label="anchor" href="#visualization"></a>
</h2>
<p>We can see how the slope of the logistic distribution becomes less
steep with higher values of <span class="math inline">a</span>. The
lower values are representative of a species where there is very little
intraspecific variation in size at maturity; if the true L50 is 100 mm,
almost all individuals will become mature close to 100 mm. In contrast,
the high parameters represent a species where there is significant
variation in L50 between individuals.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#5D74A5"</span>, <span class="st">"#819AC2"</span>, <span class="st">"#A6C1DF"</span>, <span class="st">"#CAD9DC"</span>, <span class="st">"#ECEDCE"</span>,</span>
<span>         <span class="st">"#F9E3B6"</span>, <span class="st">"#F1BD96"</span>, <span class="st">"#E39778"</span>, <span class="st">"#C57663"</span>, <span class="st">"#A8554E"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Logistic curves with different slope parameters</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fake_crustaceans</span>, </span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">prob_mat</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">slope_options</span><span class="op">)</span><span class="op">)</span>, </span>
<span>            linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">100</span>, lty <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"gray2"</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">pal</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Carapace width (mm)"</span>, y <span class="op">=</span> <span class="st">"Probability of maturity"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Slope parameter"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fl">0</span>, r <span class="op">=</span> <span class="fl">10</span>, b <span class="op">=</span> <span class="fl">0</span>, l <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fl">10</span>, r <span class="op">=</span> <span class="fl">0</span>, b <span class="op">=</span> <span class="fl">0</span>, l <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">13</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="simulations_files/figure-html/fig-logisticslopes-1.png" alt="Probability of maturity function with varying slope parameters. The vertical dashed line represents the size at maturity/inflection point/location parameter, which is set to 100 mm." width="700"><p class="caption">
Probability of maturity function with varying slope parameters. The
vertical dashed line represents the size at maturity/inflection
point/location parameter, which is set to 100 mm.
</p>
</div>
<p>Another way of visualizing the impact of changing the slope parameter
<span class="math inline">(a)</span> is by comparing density plots of
maturity by CW. We can see that the area of intersection between the
immature and mature curves increases with increasing values of <span class="math inline">a</span>. The right tail of the immature
distribution extends to much higher CW values when <span class="math inline">a=10</span> compared to when <span class="math inline">a=1</span>, while the left tail of the mature
distribution extends much lower.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Size by maturity stage density plots</span></span>
<span><span class="va">fake_crustaceans</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">slope_options</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">7</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, group <span class="op">=</span> <span class="va">mature</span>, color <span class="op">=</span> <span class="va">mature</span>, fill <span class="op">=</span> <span class="va">mature</span><span class="op">)</span>, </span>
<span>               alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="va">mytheme</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">slope_options</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">NULL</span>, color <span class="op">=</span> <span class="cn">NULL</span>, x <span class="op">=</span> <span class="st">"Carapace width (mm)"</span>, y <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span> <span class="op">=</span> <span class="st">"#368aab"</span>, <span class="st">"1"</span> <span class="op">=</span> <span class="st">"#993843"</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span> <span class="op">=</span> <span class="st">"Immature"</span>, <span class="st">"1"</span> <span class="op">=</span> <span class="st">"Mature"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span> <span class="op">=</span> <span class="st">"#7bbcd5"</span>, <span class="st">"1"</span> <span class="op">=</span> <span class="st">"#CA6E78"</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span> <span class="op">=</span> <span class="st">"Immature"</span>, <span class="st">"1"</span> <span class="op">=</span> <span class="st">"Mature"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="simulations_files/figure-html/fig-logisticdensity-1.png" alt="Density plots illustrating smoothed distributions of mature and immature crabs over a range of carapace widths for four different values controlling the shape of the underlying logistic function." width="700"><p class="caption">
Density plots illustrating smoothed distributions of mature and immature
crabs over a range of carapace widths for four different values
controlling the shape of the underlying logistic function.
</p>
</div>
<p>Let’s visualize the data with the default slope parameter of 5 and
minimal error:</p>
<div class="panel-tabset">


<ul class="nav nav-tabs" id="NA" role="tablist">
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#original-scale" id="original-scale-tab" type="button" role="tab" aria-controls="original-scale" aria-selected="true" class="active nav-link">Original scale</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#log-scale" id="log-scale-tab" type="button" role="tab" aria-controls="log-scale" aria-selected="false" class="nav-link">Log scale</button></li>
</ul>
<div class="tab-content">
<div class="active  tab-pane" id="original-scale" role="tabpanel" aria-labelledby="original-scale-tab">

<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Lines only - original scale</span></span>
<span><span class="va">fake_crustaceans</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">slope_options</span> <span class="op">==</span> <span class="fl">5</span>, <span class="va">errs</span> <span class="op">==</span> <span class="st">"none"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, color <span class="op">=</span> <span class="va">mature</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">name</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="va">mytheme</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Carapace width (mm)"</span>, y <span class="op">=</span> <span class="st">"Chela height (mm)"</span>, color <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">100</span>, lty <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"gray"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span> <span class="op">=</span> <span class="st">"#7bbcd5"</span>, <span class="st">"1"</span> <span class="op">=</span> <span class="st">"#CA6E78"</span><span class="op">)</span>,</span>
<span>                     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span> <span class="op">=</span> <span class="st">"Immature"</span>, <span class="st">"1"</span> <span class="op">=</span> <span class="st">"Mature"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="simulations_files/figure-html/fig-origlinesonly-1.png" alt="Chela height (mm) vs. carapace width (mm) for the different allometric parameter sets" width="700"><p class="caption">
Chela height (mm) vs. carapace width (mm) for the different allometric
parameter sets
</p>
</div>
</div>
<div class="tab-pane" id="log-scale" role="tabpanel" aria-labelledby="log-scale-tab">

<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Lines only - log scale</span></span>
<span><span class="va">fake_crustaceans</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">slope_options</span> <span class="op">==</span> <span class="fl">5</span>, <span class="va">errs</span> <span class="op">==</span> <span class="st">"none"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">log_x</span>, y <span class="op">=</span> <span class="va">log_y</span>, color <span class="op">=</span> <span class="va">mature</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">name</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="va">mytheme</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Log carapace width (mm)"</span>, y <span class="op">=</span> <span class="st">"Log chela height (mm)"</span>, color <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, lty <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"gray"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span> <span class="op">=</span> <span class="st">"#7bbcd5"</span>, <span class="st">"1"</span> <span class="op">=</span> <span class="st">"#CA6E78"</span><span class="op">)</span>,</span>
<span>                     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span> <span class="op">=</span> <span class="st">"Immature"</span>, <span class="st">"1"</span> <span class="op">=</span> <span class="st">"Mature"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="simulations_files/figure-html/fig-loglinesonly-1.png" alt="Log chela height vs. log carapace width for the different allometric parameter sets" width="700"><p class="caption">
Log chela height vs. log carapace width for the different allometric
parameter sets
</p>
</div>
</div>
</div>
</div>
<p>Now we add data points for the three different error levels:</p>
<div class="panel-tabset">


<ul class="nav nav-tabs" id="NA" role="tablist">
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#original-scale-1" id="original-scale-1-tab" type="button" role="tab" aria-controls="original-scale-1" aria-selected="true" class="active nav-link">Original scale</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#log-scale-1" id="log-scale-1-tab" type="button" role="tab" aria-controls="log-scale-1" aria-selected="false" class="nav-link">Log scale</button></li>
</ul>
<div class="tab-content">
<div class="active  tab-pane" id="original-scale-1" role="tabpanel" aria-labelledby="original-scale-1-tab">

<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Points and lines for one shape parameter and 3 error combos - original scale</span></span>
<span><span class="va">fake_crustaceans</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">slope_options</span> <span class="op">==</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">100</span>, lty <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"gray"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, color <span class="op">=</span> <span class="va">mature</span>, fill <span class="op">=</span> <span class="va">mature</span><span class="op">)</span>, </span>
<span>    alpha <span class="op">=</span> <span class="fl">0.5</span>, shape <span class="op">=</span> <span class="fl">21</span>, size <span class="op">=</span> <span class="fl">1</span>, stroke <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">errs</span> <span class="op">~</span> <span class="va">name</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">mytheme</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Carapace width (mm)"</span>, y <span class="op">=</span> <span class="st">"Chela height (mm)"</span>,</span>
<span>       color <span class="op">=</span> <span class="cn">NULL</span>, fill <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span> <span class="op">=</span> <span class="st">"#368aab"</span>, <span class="st">"1"</span> <span class="op">=</span> <span class="st">"#993843"</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span> <span class="op">=</span> <span class="st">"Immature"</span>, <span class="st">"1"</span> <span class="op">=</span> <span class="st">"Mature"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span> <span class="op">=</span> <span class="st">"#7bbcd5"</span>, <span class="st">"1"</span> <span class="op">=</span> <span class="st">"#CA6E78"</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span> <span class="op">=</span> <span class="st">"Immature"</span>, <span class="st">"1"</span> <span class="op">=</span> <span class="st">"Mature"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>lty <span class="op">=</span> <span class="st">"none"</span>, </span>
<span>         color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">200</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="simulations_files/figure-html/unnamed-chunk-15-1.png" alt="Chela height (mm) vs. carapace width (mm) for the different allometric parameter sets and error options" width="700"><p class="caption">
Chela height (mm) vs. carapace width (mm) for the different allometric
parameter sets and error options
</p>
</div>
</div>
<div class="tab-pane" id="log-scale-1" role="tabpanel" aria-labelledby="log-scale-1-tab">

<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Points and lines for one shape parameter and 3 error combos - log scale</span></span>
<span><span class="va">fake_crustaceans</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">slope_options</span> <span class="op">==</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, lty <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"gray"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">log_x</span>, y <span class="op">=</span> <span class="va">log_y</span>, color <span class="op">=</span> <span class="va">mature</span>, fill <span class="op">=</span> <span class="va">mature</span><span class="op">)</span>, </span>
<span>    alpha <span class="op">=</span> <span class="fl">0.5</span>, shape <span class="op">=</span> <span class="fl">21</span>, size <span class="op">=</span> <span class="fl">1</span>, stroke <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">errs</span> <span class="op">~</span> <span class="va">name</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">mytheme</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Log carapace width (mm)"</span>, y <span class="op">=</span> <span class="st">"Log chela height (mm)"</span>,</span>
<span>       color <span class="op">=</span> <span class="cn">NULL</span>, fill <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span> <span class="op">=</span> <span class="st">"#368aab"</span>, <span class="st">"1"</span> <span class="op">=</span> <span class="st">"#993843"</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span> <span class="op">=</span> <span class="st">"Immature"</span>, <span class="st">"1"</span> <span class="op">=</span> <span class="st">"Mature"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span> <span class="op">=</span> <span class="st">"#7bbcd5"</span>, <span class="st">"1"</span> <span class="op">=</span> <span class="st">"#CA6E78"</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span> <span class="op">=</span> <span class="st">"Immature"</span>, <span class="st">"1"</span> <span class="op">=</span> <span class="st">"Mature"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>lty <span class="op">=</span> <span class="st">"none"</span>, </span>
<span>         color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="simulations_files/figure-html/unnamed-chunk-16-1.png" alt="Log chela height vs. log carapace width for the different allometric parameter sets and error options" width="700"><p class="caption">
Log chela height vs. log carapace width for the different allometric
parameter sets and error options
</p>
</div>
</div>
</div>
</div>
<p>Keeping the error levels low, here is what each allometric parameter
set looks like when we change the logistic slope parameter:</p>
<div class="panel-tabset">


<ul class="nav nav-tabs" id="NA" role="tablist">
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#original-scale-2" id="original-scale-2-tab" type="button" role="tab" aria-controls="original-scale-2" aria-selected="true" class="active nav-link">Original scale</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#log-scale-2" id="log-scale-2-tab" type="button" role="tab" aria-controls="log-scale-2" aria-selected="false" class="nav-link">Log scale</button></li>
</ul>
<div class="tab-content">
<div class="active  tab-pane" id="original-scale-2" role="tabpanel" aria-labelledby="original-scale-2-tab">

<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fake_crustaceans</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">errs</span> <span class="op">==</span> <span class="st">"low"</span>, <span class="va">slope_options</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">7</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">100</span>, lty <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"gray"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, color <span class="op">=</span> <span class="va">mature</span>, fill <span class="op">=</span> <span class="va">mature</span><span class="op">)</span>,</span>
<span>             shape <span class="op">=</span> <span class="fl">21</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">1</span>, stroke <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">slope_options</span> <span class="op">~</span> <span class="va">name</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="va">mytheme</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Carapace width (mm)"</span>, y <span class="op">=</span> <span class="st">"Chela height (mm)"</span>,</span>
<span>       color <span class="op">=</span> <span class="cn">NULL</span>, fill <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span> <span class="op">=</span> <span class="st">"#368aab"</span>, <span class="st">"1"</span> <span class="op">=</span> <span class="st">"#993843"</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span> <span class="op">=</span> <span class="st">"Immature"</span>, <span class="st">"1"</span> <span class="op">=</span> <span class="st">"Mature"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span> <span class="op">=</span> <span class="st">"#7bbcd5"</span>, <span class="st">"1"</span> <span class="op">=</span> <span class="st">"#CA6E78"</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span> <span class="op">=</span> <span class="st">"Immature"</span>, <span class="st">"1"</span> <span class="op">=</span> <span class="st">"Mature"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>lty <span class="op">=</span> <span class="st">"none"</span>, </span>
<span>         fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">200</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="simulations_files/figure-html/unnamed-chunk-17-1.png" alt="Chela height vs. carapace width for the different allometric parameter sets and logistic slope options" width="700"><p class="caption">
Chela height vs. carapace width for the different allometric parameter
sets and logistic slope options
</p>
</div>
</div>
<div class="tab-pane" id="log-scale-2" role="tabpanel" aria-labelledby="log-scale-2-tab">

<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fake_crustaceans</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">errs</span> <span class="op">==</span> <span class="st">"low"</span>, <span class="va">slope_options</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">7</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, lty <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"gray"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">log_x</span>, y <span class="op">=</span> <span class="va">log_y</span>, color <span class="op">=</span> <span class="va">mature</span>, fill <span class="op">=</span> <span class="va">mature</span><span class="op">)</span>,</span>
<span>             shape <span class="op">=</span> <span class="fl">21</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">1</span>, stroke <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">slope_options</span> <span class="op">~</span> <span class="va">name</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="va">mytheme</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Log carapace width (mm)"</span>, y <span class="op">=</span> <span class="st">"Log chela height (mm)"</span>,</span>
<span>       color <span class="op">=</span> <span class="cn">NULL</span>, fill <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span> <span class="op">=</span> <span class="st">"#368aab"</span>, <span class="st">"1"</span> <span class="op">=</span> <span class="st">"#993843"</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span> <span class="op">=</span> <span class="st">"Immature"</span>, <span class="st">"1"</span> <span class="op">=</span> <span class="st">"Mature"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span> <span class="op">=</span> <span class="st">"#7bbcd5"</span>, <span class="st">"1"</span> <span class="op">=</span> <span class="st">"#CA6E78"</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span> <span class="op">=</span> <span class="st">"Immature"</span>, <span class="st">"1"</span> <span class="op">=</span> <span class="st">"Mature"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>lty <span class="op">=</span> <span class="st">"none"</span>, </span>
<span>         fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="simulations_files/figure-html/unnamed-chunk-18-1.png" alt="Log chela height vs. log carapace width for the different allometric parameter sets and logistic slope options" width="700"><p class="caption">
Log chela height vs. log carapace width for the different allometric
parameter sets and logistic slope options
</p>
</div>
</div>
</div>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-austin2006" class="csl-entry">
Austin, M. P., L. Belbin, J. A. Meyers, M. D. Doherty, and M. Luoto.
2006. <span>“Evaluation of Statistical Models Used for Predicting Plant
Species Distributions: Role of Artificial Data and Theory.”</span>
<em>Ecological Modelling</em>, Predicting species distributions, 199
(2): 197–216. <a href="https://doi.org/10.1016/j.ecolmodel.2006.05.023" class="external-link">https://doi.org/10.1016/j.ecolmodel.2006.05.023</a>.
</div>
<div id="ref-ballantyne2013" class="csl-entry">
Ballantyne, Ford. 2013. <span>“Evaluating Model Fit to Determine If
Logarithmic Transformations Are Necessary in Allometry: A Comment on the
Exchange Between Packard (2009) and Kerkhoff and Enquist (2009).”</span>
<em>Journal of Theoretical Biology</em> 317 (January): 418–21. <a href="https://doi.org/10.1016/j.jtbi.2012.09.035" class="external-link">https://doi.org/10.1016/j.jtbi.2012.09.035</a>.
</div>
<div id="ref-deroba2015" class="csl-entry">
Deroba, J. J., D. S. Butterworth, R.D., Jr Methot, J. A. A. De Oliveira,
C. Fernandez, A. Nielsen, S. X. Cadrin, et al. 2015. <span>“Simulation
Testing the Robustness of Stock Assessment Models to Error: Some Results
from the ICES Strategic Initiative on Stock Assessment Methods.”</span>
<em>ICES Journal of Marine Science</em> 72 (1): 19–30. <a href="https://doi.org/10.1093/icesjms/fst237" class="external-link">https://doi.org/10.1093/icesjms/fst237</a>.
</div>
<div id="ref-echavarría-heras2024" class="csl-entry">
Echavarría-Heras, Héctor, Enrique Villa-Diharce, Abelardo
Montesinos-López, and Cecilia Leal-Ramírez. 2024. <span>“An Extended
Multiplicative Error Model of Allometry: Incorporating Systematic
Components, Non-Normal Distributions, and Piecewise
Heteroscedasticity.”</span> <em>Biology Methods and Protocols</em> 9
(1): bpae024. <a href="https://doi.org/10.1093/biomethods/bpae024" class="external-link">https://doi.org/10.1093/biomethods/bpae024</a>.
</div>
<div id="ref-kerkhoff2009" class="csl-entry">
Kerkhoff, Andrew J., and Brian J. Enquist. 2009. <span>“Multiplicative
by Nature: Why Logarithmic Transformation Is Necessary in
Allometry.”</span> <em>Journal of Theoretical Biology</em> 257 (3):
519–21. <a href="https://doi.org/10.1016/j.jtbi.2008.12.026" class="external-link">https://doi.org/10.1016/j.jtbi.2008.12.026</a>.
</div>
<div id="ref-lotterhos2022" class="csl-entry">
Lotterhos, Katie E., Matthew C. Fitzpatrick, and Heath Blackmon. 2022.
<span>“Simulation Tests of Methods in Evolution, Ecology, and
Systematics: Pitfalls, Progress, and Principles.”</span> <em>Annual
Review of Ecology, Evolution, and Systematics</em> 53 (1): 113–36. <a href="https://doi.org/10.1146/annurev-ecolsys-102320-093722" class="external-link">https://doi.org/10.1146/annurev-ecolsys-102320-093722</a>.
</div>
<div id="ref-packard2009" class="csl-entry">
Packard, Gary C. 2009. <span>“On the Use of Logarithmic Transformations
in Allometric Analyses.”</span> <em>Journal of Theoretical Biology</em>
257 (3): 515–18. <a href="https://doi.org/10.1016/j.jtbi.2008.10.016" class="external-link">https://doi.org/10.1016/j.jtbi.2008.10.016</a>.
</div>
<div id="ref-piner2011" class="csl-entry">
Piner, Kevin R., Hui-Hua Lee, Mark N. Maunder, and Richard D. Methot.
2011. <span>“A Simulation-Based Method to Determine Model
Misspecification: Examples Using Natural Mortality and Population
Dynamics Models.”</span> <em>Marine and Coastal Fisheries</em> 3 (1):
336343. <a href="https://doi.org/10.1080/19425120.2011.611005" class="external-link">https://doi.org/10.1080/19425120.2011.611005</a>.
</div>
<div id="ref-xiao2011" class="csl-entry">
Xiao, Xiao, Ethan P. White, Mevin B. Hooten, and Susan L. Durham. 2011.
<span>“On the Use of Log-Transformation Vs. Nonlinear Regression for
Analyzing Biological Power Laws.”</span> <em>Ecology</em> 92 (10):
1887–94. <a href="https://doi.org/10.1890/11-0538.1" class="external-link">https://doi.org/10.1890/11-0538.1</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ruby Krasnow.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
