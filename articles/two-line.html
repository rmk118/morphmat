<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Two-line models • morphmat</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Two-line models">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">morphmat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/broken-stick.html">Broken-stick methods</a></li>
    <li><a class="dropdown-item" href="../articles/classification.html">Classification methods</a></li>
    <li><a class="dropdown-item" href="../articles/simulations.html">Simulating data</a></li>
    <li><a class="dropdown-item" href="../articles/two-line.html">Two-line models</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rmk118/morphmat/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Two-line models</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rmk118/morphmat/blob/master/vignettes/two-line.Rmd" class="external-link"><code>vignettes/two-line.Rmd</code></a></small>
      <div class="d-none name"><code>two-line.Rmd</code></div>
    </div>

    
    
<!-- Here I will write a vignette explaining all of the two-line regression methods. This will be useful for referring readers to more complex options available in packages like `chngpt` that are not available within `morphmat`. -->
<div class="section level3">
<h3 id="sec-twoA">Description<a class="anchor" aria-label="anchor" href="#sec-twoA"></a>
</h3>
<p>Two-line models differ from broken-stick models because the
intersection point of the line representing the immature individuals and
the line representing mature individuals is not necessarily the same as
the optimal breakpoint value (the value on the x-axis where the y-values
switch from being predicted by the immature line to being predicted by
the mature line).</p>
<p>We will test two slightly different versions of this approach using
code from Crab_Maturity (Stevens, 2020). The first version uses a
piecewise regression model to find the x-value/breakpoint that gives the
lowest mean square error (MSE) by iteratively testing each observed
x-value within the range of unknown maturity. In the second version, the
tested x-values are evenly spaced points within the unknown range, and
may not equal actual observed values (like REGRANS). The number of (and
therefore interval between) points can be user-defined.</p>
<p>The SM50 could be defined as the optimal breakpoint OR as the point
at which the two lines actually intersect; i.e. where the regression
equations predict the same y-value. The intersection point may be much
lower or higher than the previously determined breakpoint and can even
be negative, so it is often more reasonable to use the breakpoint as our
estimate of SM50.</p>
</div>
<div class="section level2">
<h2 id="two-line-standard">Two-line: standard<a class="anchor" aria-label="anchor" href="#two-line-standard"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span> <span class="co"># set seed for reproducibility</span></span>
<span></span>
<span><span class="va">fc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fake_crustaceans.html">fake_crustaceans</a></span><span class="op">(</span></span>
<span>  error_scale <span class="op">=</span> <span class="fl">17</span>,</span>
<span>  slope <span class="op">=</span> <span class="fl">9</span>,</span>
<span>  L50 <span class="op">=</span> <span class="fl">75</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">800</span>,</span>
<span>  allo_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0.25</span>, <span class="fl">1.05</span>, <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>  x_mean <span class="op">=</span> <span class="fl">85</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="two-line_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>The default function call iterates over 100 evenly-spaced points
between the default upper and lower bounds (0.2 and 0.8 quantiles of the
x-axis variable) of the region to search for possible SM50 values.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">two_line_est</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/two_line.html">two_line</a></span><span class="op">(</span><span class="va">fc</span>, <span class="st">"x"</span>, <span class="st">"y"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">two_line_est</span></span>
<span><span class="co">#&gt;   breakpoint intersection </span></span>
<span><span class="co">#&gt;     88.01449    385.85516</span></span></code></pre></div>
<p>The result can be influenced by the number of breakpoints tested:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/two_line.html">two_line</a></span><span class="op">(</span><span class="va">fc</span>, <span class="st">"x"</span>, <span class="st">"y"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>, num_bps <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="co">#&gt;   breakpoint intersection </span></span>
<span><span class="co">#&gt;     87.59491    529.48825</span></span>
<span><span class="fu"><a href="../reference/two_line.html">two_line</a></span><span class="op">(</span><span class="va">fc</span>, <span class="st">"x"</span>, <span class="st">"y"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>, num_bps <span class="op">=</span> <span class="fl">400</span><span class="op">)</span></span>
<span><span class="co">#&gt;   breakpoint intersection </span></span>
<span><span class="co">#&gt;     87.63043    529.48825</span></span></code></pre></div>
<p>Alternatively, possible breakpoints can be restricted to values of
the x-axis variable present in the data:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/two_line.html">two_line</a></span><span class="op">(</span><span class="va">fc</span>, <span class="st">"x"</span>, <span class="st">"y"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>, bps <span class="op">=</span> <span class="st">"obs"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   breakpoint intersection </span></span>
<span><span class="co">#&gt;     88.03361    435.79877</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="two-line-logistic-transition">Two-line: logistic transition<a class="anchor" aria-label="anchor" href="#two-line-logistic-transition"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tll_est</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/two_line_logistic.html">two_line_logistic</a></span><span class="op">(</span><span class="va">fc</span>, <span class="st">"x"</span>, <span class="st">"y"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">tll_est</span></span>
<span><span class="co">#&gt;     SM50 </span></span>
<span><span class="co">#&gt; 77.93902</span></span></code></pre></div>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ruby Krasnow.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
