<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Modeling Size at Maturity Using Morphometric Data • morphmat</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="katex-auto.js"></script><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><link href="deps/KaTex-0.16.10/katex.min.css" rel="stylesheet">
<script src="deps/KaTex-0.16.10/katex.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Modeling Size at Maturity Using Morphometric Data">
<meta name="description" content="A compilation of methods used to estimate size at (sexual) maturity based on morphometric data, most commonly applied to crabs, lobsters, and other crustaceans. Approaches include modeling approaches based on piecewise/segmentedlinear regression as well as numerous clustering-based methods.">
<meta property="og:description" content="A compilation of methods used to estimate size at (sexual) maturity based on morphometric data, most commonly applied to crabs, lobsters, and other crustaceans. Approaches include modeling approaches based on piecewise/segmentedlinear regression as well as numerous clustering-based methods.">
<meta property="og:image" content="https://rmk118.github.io/morphmat/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">morphmat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/morphmat.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/broken-stick.html">Broken-stick methods</a></li>
    <li><a class="dropdown-item" href="articles/classification.html">Classification methods</a></li>
    <li><a class="dropdown-item" href="articles/simulations.html">Simulating data</a></li>
    <li><a class="dropdown-item" href="articles/two-line.html">Two-line models</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rmk118/morphmat/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="morphmat">morphmat<a class="anchor" aria-label="anchor" href="#morphmat"></a>
</h1>
</div>
<p></p>
<!-- badges: start -->

<!-- badges: end -->
<p>A compilation of methods used to estimate size at (sexual) maturity based on morphometric data, most commonly applied to crabs, lobsters, and other crustaceans. Approaches include modeling approaches based on piecewise/segmented linear regression as well as numerous clustering-based methods.</p>
<p><code>morphmat</code> is intended to help fisheries scientists and managers to implement the multitude of computational methods that have been developed for estimating crustacean size at maturity. This package is being developed as part of my graduate work at the University of Maine. <strong>This is still a work in progress and should not yet be used for research purposes.</strong></p>
<p><code>morphmat</code> will include user-friendly functions for estimating size at morphometric maturity, along with guidelines for choosing the optimal method for a given dataset and correctly interpreting results. Both novel and historically popular (e.g., broken-stick regression) methods will be included, and users will be able to obtain SM50 estimates from nearly a dozen different approaches with a single function call. By combining code for the various models within a single package, morphmat will enable the application of multi-model inference to SM50 estimation, avoiding the arbitrary selection of a single “best” model (<a href="#ref-katsanevakis2006">Katsanevakis 2006</a>). By increasing the accessibility of modern statistical methods for estimating SM50, I hope to facilitate the widespread adoption of improved SM50 modeling procedures.</p>
<p><code>morphmat</code> will include versions of the methods implemented in these existing GitHub repositories:</p>
<table class="table">
<colgroup>
<col width="25%">
<col width="25%">
<col width="25%">
<col width="25%">
</colgroup>
<tbody>
<tr class="odd">
<td><strong>Type</strong></td>
<td><strong>Authors</strong></td>
<td><strong>GitHub repository</strong></td>
<td><strong>Description/notes</strong></td>
</tr>
<tr class="even">
<td>Package</td>
<td>Josymar Torrejon-Magallanes</td>
<td><a href="https://github.com/ejosymart/sizeMat" class="external-link">ejosymart/sizeMat</a></td>
<td><a href="https://cran.r-project.org/web/packages/sizeMat/vignettes/sizeMat.html" class="external-link">sizeMat: An R Package to Estimate Size at Sexual Maturity</a></td>
</tr>
<tr class="odd">
<td>Package</td>
<td>Rodrigo Sant’Ana, Fernando Mayer</td>
<td><a href="https://github.com/rodrigosantana/Regrans" class="external-link">rodrigosantana/Regrans: Fits Segmented Linear Regression Models</a></td>
<td>Older repository: <a href="https://github.com/fernandomayer/Regrans/blob/master/change.point.R" class="external-link">fernandomayer/Regrans</a>
</td>
</tr>
<tr class="even">
<td>Package</td>
<td>Derek Sonderegger</td>
<td><a href="https://cran.r-project.org/web/packages/SiZer/index.html" class="external-link">siZer</a></td>
<td>
<a href="https://zenodo.org/records/5002120" class="external-link">Conduct size at morphometric maturity analysis (SMM) and plot results using the SiZer extension package</a> by Olson, Andrew P., Siddon, Chris E., and Eckert, Ginny L.</td>
</tr>
<tr class="odd">
<td>Package</td>
<td>Vito M. R. Muggeo</td>
<td><a href="https://cran.r-project.org/web/packages/segmented/index.html" class="external-link">segmented</a></td>
<td><a href="https://cran.r-project.org/web/packages/segmented/segmented.pdf" class="external-link">package reference manual</a></td>
</tr>
<tr class="even">
<td>Package</td>
<td>Youyi Fong</td>
<td><a href="https://doi.org/10.32614/CRAN.package.chngpt" class="external-link">chngpt</a></td>
<td>
<a href="https://cran.r-project.org/web/packages/chngpt/vignettes/chngpt-vignette.pdf" class="external-link">Fitting Threshold Regression Models Using chngpt</a> (vignette)</td>
</tr>
<tr class="odd">
<td>Package</td>
<td>Tobie Surette</td>
<td><a href="https://github.com/TobieSurette/gulf.stats" class="external-link">TobieSurette/gulf.stats</a></td>
<td>See files <a href="https://github.com/TobieSurette/gulf.stats/blob/master/R/morphometric.maturity.R" class="external-link">morphometric.maturity.R</a> and <a href="https://github.com/TobieSurette/gulf.stats/blob/master/R/morphometry.R" class="external-link">morphometry.R</a>
</td>
</tr>
<tr class="even">
<td>R scripts</td>
<td>Bradley Stevens</td>
<td><a href="https://github.com/Crabman52/Crustacean_Sensation" class="external-link">Crabman52/Crustacean_Sensation</a></td>
<td>Include three different methods for separating mature from immature crabs based on allometric growth of body parts, with code based on Somerton’s (1980) program MATURE</td>
</tr>
</tbody>
</table>
<p>The following scripts do not use morphometric data and require individuals to already be classified as mature or immature. They provide various examples of how to fit maturity~length binomial models to estimate SM50 and obtain confidence intervals. These tools can also be used to calculate size at maturity for non-crustacean fisheries. For a comprehensive examination of this type of model, see Mainguy et al (<a href="#ref-mainguy2024">2024</a>).</p>
<table class="table">
<colgroup>
<col width="25%">
<col width="25%">
<col width="25%">
<col width="25%">
</colgroup>
<tbody>
<tr class="odd">
<td><strong>Type</strong></td>
<td><strong>Authors</strong></td>
<td><strong>GitHub repository</strong></td>
<td><strong>Description/notes</strong></td>
</tr>
<tr class="even">
<td>R scripts</td>
<td>Lucas Rodrigues</td>
<td><a href="https://github.com/lvcasrodrigues/maturity_at_size" class="external-link">lvcasrodrigues/maturity_at_size</a></td>
<td>Does not use morphometric data; takes size classes with known numbers of mature individuals per size class and fits a binomial model (frequentist or Bayesian). Finds SM50 by generating new data from the model rather than from ratio of parameters</td>
</tr>
<tr class="odd">
<td>R scripts</td>
<td>Mainguy et al.</td>
<td>
<a href="https://github.com/rafamoral/L50" class="external-link">rafamoral/L50</a>: Monitoring reproduction in fish: Assessing the adequacy of ogives and the predicted uncertainty of their <em>L</em><sub>50</sub> estimates for more reliable biological inferences</td>
<td>Over a dozen methods for estimating L50 values and obtaining confidence intervals from (frequentist or Bayesian) binomial models (Delta, Fieller, bootstrap resampling, profile-likelihood, etc.). See accompanying manuscript by Mainguy et al. (<a href="#ref-mainguy2024">2024</a>).</td>
</tr>
<tr class="even">
<td>R script</td>
<td><a href="https://scholar.google.com.au/citations?user=hb4nzPYAAAAJ&amp;hl" class="external-link">Alastair V. Harry</a></td>
<td><a href="https://gist.github.com/alharry/4576675" class="external-link">Alharry/Maturity.ogive.R</a></td>
<td>Includes bootstrap resampling to obtain 95% CIs</td>
</tr>
</tbody>
</table>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of morphmat from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"rmk118/morphmat"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rmk118/morphmat" class="external-link">morphmat</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span> <span class="co"># for reproducibility when generating the simulated data</span></span>
<span></span>
<span><span class="co"># Generate a simulated dataset with known size at maturity</span></span>
<span><span class="va">fc</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fake_crustaceans.html">fake_crustaceans</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, L50 <span class="op">=</span> <span class="fl">100</span>, allo_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.2</span>, <span class="fl">1.1</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="broken-stickpiecewise-regression-methods">Broken-stick/piecewise regression methods<a class="anchor" aria-label="anchor" href="#broken-stickpiecewise-regression-methods"></a>
</h3>
<p>REGRANS:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/regrans.html">regrans</a></span><span class="op">(</span><span class="va">fc</span>, <span class="st">"x"</span>, <span class="st">"y"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 89.43822</span></span></code></pre></div>
<p>Two-line logistic:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/two_line_logistic.html">two_line_logistic</a></span><span class="op">(</span><span class="va">fc</span>, xvar <span class="op">=</span> <span class="st">"x"</span>, yvar <span class="op">=</span> <span class="st">"y"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>, SM50_start <span class="op">=</span> <span class="fl">105</span><span class="op">)</span></span>
<span><span class="co">#&gt;     SM50 </span></span>
<span><span class="co">#&gt; 104.7636</span></span></code></pre></div>
<p>Two-line model (lines are fit separately; no forced intersection):</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/two_line.html">two_line</a></span><span class="op">(</span><span class="va">fc</span>, xvar <span class="op">=</span> <span class="st">"x"</span>, yvar <span class="op">=</span> <span class="st">"y"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt;   breakpoint intersection </span></span>
<span><span class="co">#&gt;     106.0655    1383.9744</span></span></code></pre></div>
<p>Broken-stick Stevens (only iterates over values of the x-axis variable present in the data):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/broken_stick_stevens.html">broken_stick_stevens</a></span><span class="op">(</span><span class="va">fc</span>, xvar <span class="op">=</span> <span class="st">"x"</span>, yvar <span class="op">=</span> <span class="st">"y"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 91.10524</span></span></code></pre></div>
<p>Other packages:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># segmented</span></span>
<span><span class="co"># chngpt</span></span></code></pre></div>
<p>Compare estimates from all piecewise regression methods:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/piecewise_mods.html">piecewise_mods</a></span><span class="op">(</span><span class="va">fc</span>, xvar <span class="op">=</span> <span class="st">"x"</span>, yvar <span class="op">=</span> <span class="st">"y"</span>, method <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span>
<span><span class="co">#&gt;                chngpt             segmented               REGRANS </span></span>
<span><span class="co">#&gt;              89.44561              88.71463              89.43822 </span></span>
<span><span class="co">#&gt;               Stevens   Two_line.breakpoint Two_line.intersection </span></span>
<span><span class="co">#&gt;              91.10524             106.06548            1383.97444</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="clustering-methods">Clustering methods<a class="anchor" aria-label="anchor" href="#clustering-methods"></a>
</h3>
<p>Somerton method:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/somerton.html">somerton</a></span><span class="op">(</span><span class="va">fc</span>, xvar <span class="op">=</span> <span class="st">"x"</span>, yvar <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">out_df</span>, <span class="va">pred_mat_num</span> <span class="op">~</span> <span class="va">x</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 102.37</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-katsanevakis2006" class="csl-entry">
Katsanevakis, Stelios. 2006. “Modelling Fish Growth: Model Selection, Multi-Model Inference and Model Selection Uncertainty.” <em>Fisheries Research</em> 81 (2): 229–35. <a href="https://doi.org/10.1016/j.fishres.2006.07.002" class="external-link uri">https://doi.org/10.1016/j.fishres.2006.07.002</a>.
</div>
<div id="ref-mainguy2024" class="csl-entry">
Mainguy, Julien, Martin Bélanger, Geneviève Ouellet-Cauchon, and Rafael de Andrade Moral. 2024. “Monitoring Reproduction in Fish: Assessing the Adequacy of Ogives and the Predicted Uncertainty of Their <em>L</em>50 Estimates for More Reliable Biological Inferences.” <em>Fisheries Research</em> 269 (January): 106863. <a href="https://doi.org/10.1016/j.fishres.2023.106863" class="external-link uri">https://doi.org/10.1016/j.fishres.2023.106863</a>.
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/rmk118/morphmat/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/rmk118/morphmat/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing morphmat</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Ruby Krasnow <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0009-0007-0531-8420" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://www.repostatus.org/#wip" class="external-link"><img src="https://www.repostatus.org/badges/latest/wip.svg" alt="Project Status: WIP – Initial development is in progress, but there has not yet been a stable, usable release suitable for the public."></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ruby Krasnow.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
